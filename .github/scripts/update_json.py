#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import os
import datetime
from datetime import timedelta

# 文件路径
json_file_path = 'resources/json/XPSky/2.每日单独季蜡.json'

# 确保目录存在
os.makedirs(os.path.dirname(json_file_path), exist_ok=True)

# 定义地图数据，与提交季蜡.js中的数据保持一致
maps = [
    {
        "name": "云野",
        "data": {"2477345666": [4283171097, 4283171105, 4283171067, 4283171049, 4283171054, 4283171194, 4283171195, 4283171197, 4283171196, 4283171104, 4283171096, 4283171100, 4283171073, 4283171098, 4283171101, 4283171037, 4283171063, 4283171044, 4283171095, 4283171103, 4283171102, 4283171189, 4283170861, 4283171048]}
    },
    {
        "name": "雨林",
        "data": {"164626931": [4283171166, 4283171167, 4283171168, 4283171196, 4283171195, 4283171197, 4283171192, 4283171193, 4283171194, 4283171183, 4283171182, 4283171181, 4283171189, 4283171186, 4283171191, 4283171173, 4283171174, 4283171172, 4283171187, 4283171188, 4283171190, 4283171178, 4283171177, 4283171176]}
    },
    {
        "name": "霞谷",
        "data": {"1638008359": [4283171340, 4283171347, 4283171348, 4283171332, 4283171336, 4283171337, 4283171349, 4283171342, 4283171341, 4283171330, 4283171333, 4283171331, 4283171335, 4283171325, 4283171329, 4283171346, 4283171343, 4283171344, 4283171338, 4283171350, 4283171339, 4283171328, 4283171334, 4283171327]}
    },
    {
        "name": "墓土",
        "data": {"1147491976": [4283170986, 4283170981, 4283170988, 4283170982, 4283170976, 4283170977, 4283170984, 4283170983, 4283170980, 4283170979, 4283170985, 4283170978, 4283171186, 4283171191, 4283171189, 4283171188, 4283171190, 4283171187, 4283171196, 4283171195, 4283171197, 4283171192, 4283171193, 4283171194]}
    },
    {
        "name": "禁阁",
        "data": {"2358907137": [4283171251, 4283171257, 4283171247, 4283171264, 4283171268, 4283171260, 4283171254, 4283171258, 4283171259, 4283171256, 4283171250, 4283171249, 4283171253, 4283171255, 4283171252, 4283171263, 4283171273, 4283171261, 4283171272, 4283171262, 4283171267, 4283170949, 4283170951, 4283170950]}
    }
]

# 计算今天是第几个地图
start_date = datetime.datetime.strptime('2024-01-04', '%Y-%m-%d')
today = datetime.datetime.now()
days = (today - start_date).days
map_index = days % len(maps)
today_map = maps[map_index]

# 获取今天要更新的地图数据
map_name = today_map["name"]
map_data = today_map["data"]

# 打印日志
print(f"更新时间: {today.strftime('%Y-%m-%d %H:%M:%S')}")
print(f"今日地图: {map_name}")
print(f"更新数据: {json.dumps(map_data)}")

# 写入文件
with open(json_file_path, 'w', encoding='utf-8') as f:
    json.dump(map_data, f) 